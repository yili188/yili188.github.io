<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="四个部分1.微控制器驱动主要是微控制器相关的驱动。比如：通用定时器驱动（General Purpose Driver,GPT Driver）、看门狗驱动（Watchdog Driver,WDG Driver）、微控制器单元驱动（Microcontroller Unit Driver,MCU Driver）和内核测试（Core Test）四个部分组成。 01.GPT Driver在AUTOSAR中有">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/07/02/AUTOSAR/1.1.%E5%BE%AE%E6%8E%A7%E5%88%B6%E5%99%A8%E6%8A%BD%E8%B1%A1%E5%B1%82MCAL(%E9%A9%B1%E5%8A%A8%E5%B1%82)/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="四个部分1.微控制器驱动主要是微控制器相关的驱动。比如：通用定时器驱动（General Purpose Driver,GPT Driver）、看门狗驱动（Watchdog Driver,WDG Driver）、微控制器单元驱动（Microcontroller Unit Driver,MCU Driver）和内核测试（Core Test）四个部分组成。 01.GPT Driver在AUTOSAR中有">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-07-02T14:49:47.132Z">
<meta property="article:modified_time" content="2021-08-07T12:56:31.985Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-AUTOSAR/1.1.微控制器抽象层MCAL(驱动层)" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/02/AUTOSAR/1.1.%E5%BE%AE%E6%8E%A7%E5%88%B6%E5%99%A8%E6%8A%BD%E8%B1%A1%E5%B1%82MCAL(%E9%A9%B1%E5%8A%A8%E5%B1%82)/" class="article-date">
  <time class="dt-published" datetime="2023-07-02T14:49:47.132Z" itemprop="datePublished">2023-07-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="四个部分"><a href="#四个部分" class="headerlink" title="四个部分"></a>四个部分</h3><h4 id="1-微控制器驱动"><a href="#1-微控制器驱动" class="headerlink" title="1.微控制器驱动"></a>1.微控制器驱动</h4><p>主要是微控制器相关的驱动。比如：通用定时器驱动（General Purpose Driver,GPT Driver）、看门狗驱动（Watchdog Driver,WDG Driver）、微控制器单元驱动（Microcontroller Unit Driver,MCU Driver）和内核测试（Core Test）四个部分组成。</p>
<h5 id="01-GPT-Driver"><a href="#01-GPT-Driver" class="headerlink" title="01.GPT Driver"></a>01.GPT Driver</h5><p>在AUTOSAR中有两类定时器，操作系统定时器和硬件定时器。该模块使用通用定时器单元的硬件定时器通道，为操作系统或者其他基础软件模块提供计时功能。</p>
<p>作用：</p>
<ul>
<li>启动和停止硬件定时器；</li>
<li>得到定时器数值；</li>
<li>控制时间触发的中断；</li>
<li>控制时间触发的中断唤醒。</li>
</ul>
<h5 id="02-WDG-Driver"><a href="#02-WDG-Driver" class="headerlink" title="02.WDG Driver"></a>02.WDG Driver</h5><p>WDG Driver的功能主要是初始化和触发看门狗。WDG Driver有内部WDG Driver和外部WDG Driver。内部WDG Driver控制MCU的内部看门狗定时器，提供触发功能和模式选择服务；外部WDG Driver控制外部硬件看门狗，与内部WDG Driver一样，提供触发功能和模式选择服务。</p>
<h5 id="03-MCU-Driver"><a href="#03-MCU-Driver" class="headerlink" title="03.MCU Driver"></a>03.MCU Driver</h5><p>MCU Driver位于MCAL层，可以直接访问微控制器硬件，它的主要功能是初始化、休眠、复位微控制器以及提供其他MCAL软件模块所需的与微控制器相关的特殊功能。MCU Driver还能够使能并设置MCU时钟，例如CPU时钟、外围器件时钟、预分频器等参数。</p>
<h5 id="04-Core-Test"><a href="#04-Core-Test" class="headerlink" title="04.Core Test"></a>04.Core Test</h5><p>Core Test（内核测试）模块包含周期性测试和启动测试。内核测试模块可以对CPU所有寄存器进行测试，提供中断控制和异常检测。该模块还对算术逻辑单元、存储保护单元和缓存控制器等进行检测。</p>
<h4 id="2-存储器驱动"><a href="#2-存储器驱动" class="headerlink" title="2.存储器驱动"></a>2.存储器驱动</h4><p>存储器驱动由内部EEPROM驱动、内部Flash驱动、RAM测试和Flash测试四部分组成。</p>
<h5 id="01-内部EEPROM驱动"><a href="#01-内部EEPROM驱动" class="headerlink" title="01.内部EEPROM驱动"></a>01.内部EEPROM驱动</h5><p>内部EEPROM驱动提供初始化服务，以及对内部EEPROM的读写、写、擦除等操作。该驱动模块一次只能接受一个任务。</p>
<h5 id="02-内部Flash驱动"><a href="#02-内部Flash驱动" class="headerlink" title="02.内部Flash驱动"></a>02.内部Flash驱动</h5><p>内部Flash驱动提供内部Flash初始化服务，以及对内部Flash的读、写、擦除等操作。该驱动还可以将Flash访问代码下载到RAM中，如果需要的话，也可以执行写、擦除操作。</p>
<h5 id="03-RAM测试"><a href="#03-RAM测试" class="headerlink" title="03.RAM测试"></a>03.RAM测试</h5><p>RAM测试模块通过软件对RAM存储进行测试。该模块包含后台测试和前台测试。其中，后台测试是异步服务，前台测试是同步服务。</p>
<h5 id="04-Flash测试"><a href="#04-Flash测试" class="headerlink" title="04.Flash测试"></a>04.Flash测试</h5><p>Flash测试模块提供算法来测试诸如数据&#x2F;程序闪存、程序SRAM等非易失性存储器，这些存储器可以是集成在微控制器内部的，也可以是外部映射到微控制器的存储器。</p>
<h4 id="3-通信驱动"><a href="#3-通信驱动" class="headerlink" title="3.通信驱动"></a>3.通信驱动</h4><p>通信驱动由以太网（Ethernet）驱动、FlexRay驱动、CAN驱动、LIN驱动和SPI驱动五部分组成。</p>
<h5 id="01-Ethernet驱动"><a href="#01-Ethernet驱动" class="headerlink" title="01.Ethernet驱动"></a>01.Ethernet驱动</h5><p>Ethernet驱动模块为以太网提供统一的接口。该驱动模块对所使用的以太网控制器的硬件特性进行了抽象。以太网接口模块使用以太网驱动层访问某些控制器。以太网驱动层由若干个以太网驱动模块组成。</p>
<h5 id="02-FlexRay驱动"><a href="#02-FlexRay驱动" class="headerlink" title="02.FlexRay驱动"></a>02.FlexRay驱动</h5><p>FlexRay驱动用来抽象不同的FlexRay通信控制器及其硬件相关的特性。通信控制器的FlexRay协议强制特性经过封装后只能通过统一的API进行访问。API提供了映射到基于实际通信控制器的硬件访问序列的抽象功能操作。因此，使用FlexRay驱动可以保证FlexRay接口独立于硬件。</p>
<p>对内部或外部FlexRay通信控制器的驱动来说，需要进行下列处理：</p>
<ul>
<li>FlexRay控制器的初始化；</li>
<li>配置数据处理单元；</li>
<li>控制指令向通信控制器的传递；</li>
<li>从协议引擎到控制器主接口状态数据的规定；</li>
<li>通信控制器和主处理机之间信息数据的传输。</li>
</ul>
<h5 id="03-CAN驱动"><a href="#03-CAN驱动" class="headerlink" title="03.CAN驱动"></a>03.CAN驱动</h5><p>CAN驱动针对的是微控制器内部的CAN控制器，它可以实现以下功能：</p>
<ul>
<li><p>对CAN控制器进行初始化；</p>
</li>
<li><p>发送和接收报文；</p>
</li>
<li><p>对报文的数据和功能进行通知（对接收报文的指示、对发送报文的确认）；</p>
</li>
<li><p>溢出和错误处理；</p>
</li>
<li><p>唤醒检测。</p>
</li>
</ul>
<p>此外，CAN驱动还具有以下特性：单个或多个CAN通道、CAN驱动的多重实例化、对接收报文的中断&#x2F;轮询模式。</p>
<p>CAN驱动是MCAL的一部分，可以执行硬件访问、向上层提供独立于硬件的API，而仅有的能够访问CAN驱动的上层是CAN接口（CAN Interface）。CAN驱动也可以为数据传输的初始化和通知接收事件的回调函数提供服务，该服务也是独立于硬件的。除此之外，CAN驱动也可以控制从属于同一个CAN硬件单元的CAN控制器的行为和状态。</p>
<h5 id="04-LIN驱动"><a href="#04-LIN驱动" class="headerlink" title="04.LIN驱动"></a>04.LIN驱动</h5><p>LIN驱动使用标准的通用异步收发器（Universal Asynchronous Receiver Transmitter,UART）或者串行通信接口（Serial Communication Interface,SCI）进行通信。</p>
<p>该模块可以完成下列任务：</p>
<ul>
<li><p>LIN硬件的初始化；</p>
</li>
<li><p>调度表的处理；</p>
</li>
<li><p>LIN报文的发送（通过标志位和函数接口确认）；</p>
</li>
<li><p>LIN报文的接收（通过标志位和函数接口指示）；</p>
</li>
<li><p>睡眠和唤醒；</p>
</li>
<li><p>协议差错的处理；</p>
</li>
<li><p>报文的超时监测。</p>
</li>
</ul>
<p>LIN驱动也是MCAL的一部分，可以执行硬件访问、向上层提供独立于硬件的API。仅有的能够访问LIN驱动的上层是LIN接口（LIN Interface）。一个LIN驱动可以支持多个通道，但是这些通道要属于同一个LIN硬件单元。</p>
<h5 id="05-SPI驱动"><a href="#05-SPI驱动" class="headerlink" title="05.SPI驱动"></a>05.SPI驱动</h5><p>SPI驱动模块是微控制器内部同步通信串行接口的驱动。SPI驱动为SPI总线上不同的设备（如EEPROM&#x2F;Watchdog等）提供读写访问服务。一个SPI设备可以被所使用的SPI硬件和相关的片选信号识别。该模块可以在主、从或者主-从模式下运行。</p>
<p>配置SPI驱动应遵循以下步骤：</p>
<ul>
<li><p>选择SPI驱动的功能级别，配置可选择的功能特性；</p>
</li>
<li><p>根据数据用途来定义SPI通道，它们可以是SPI驱动的内部缓冲器，或者是由用户提供的外部缓冲器；</p>
</li>
<li><p>根据硬件属性来定义SPI任务，它们会包含一系列使用这些属性的通道；</p>
</li>
<li><p>定义任务序列，以优先级排序的方式来传递数据。</p>
</li>
</ul>
<h4 id="4-I-x2F-O驱动"><a href="#4-I-x2F-O驱动" class="headerlink" title="4.I&#x2F;O驱动"></a>4.I&#x2F;O驱动</h4><p>I&#x2F;O驱动由PORT驱动、DIO驱动、ADC驱动、PWM驱动、ICU驱动、OCU驱动六部分组成。</p>
<h5 id="01-PORT驱动"><a href="#01-PORT驱动" class="headerlink" title="01.PORT驱动"></a>01.PORT驱动</h5><p>PORT驱动初始化就是对微控制器的整个PORT模块进行初始化配置。</p>
<p>很多端口和管脚被分配有多种不同的功能，即可以进行引脚功能复用，比如通用I&#x2F;O、模数转换、脉宽调制等功能。因此，对PORT必须有一个整体的配置和初始化，对各管脚的具体配置和使用取决于微控制器和ECU的引脚功能分配。PORT初始化数据应当尽可能高效地写到每个端口。DIO驱动中所用到的端口的配置和初始化都是在PORT驱动模块中完成的。因此，在使用DIO功能之前，应先进行PORT的初始化。</p>
<h5 id="02-DIO驱动"><a href="#02-DIO驱动" class="headerlink" title="02.DIO驱动"></a>02.DIO驱动</h5><p>DIO驱动对微控制器硬件管脚的访问进行了抽象，除此之外，还可以对管脚进行分组。该模块通过DIO通道、DIO端口以及DIO通道组来读写数据，而且这类操作是同步的。</p>
<h5 id="03-ADC驱动"><a href="#03-ADC驱动" class="headerlink" title="03.ADC驱动"></a>03.ADC驱动</h5><p>ADC驱动对微控制器内部模数转换单元进行初始化和控制。它可以提供启动和停止模数转换的服务，分别用来开启和禁用模数转换的触发源。</p>
<h5 id="04-PWM驱动"><a href="#04-PWM驱动" class="headerlink" title="04.PWM驱动"></a>04.PWM驱动</h5><p>PWM驱动为微控制器PWM模块提供初始化和控制服务，可生成周期和占空比都可变的脉冲。</p>
<h5 id="05-ICU驱动"><a href="#05-ICU驱动" class="headerlink" title="05.ICU驱动"></a>05.ICU驱动</h5><p>ICU驱动控制的是微控制器的输入捕获单元（Input Capture Unit），有两种模式：正常模式和休眠模式。</p>
<p>ICU驱动可以提供一下服务：</p>
<ul>
<li><p>信号边沿检测及通知；</p>
</li>
<li><p>中断唤醒；</p>
</li>
<li><p>周期性信号时间的测量；</p>
</li>
<li><p>边沿时间戳捕获；</p>
</li>
<li><p>边沿&#x2F;脉冲计数</p>
</li>
</ul>
<h5 id="06-OCU驱动"><a href="#06-OCU驱动" class="headerlink" title="06.OCU驱动"></a>06.OCU驱动</h5><p>OCU驱动的作用是对微控制器内部的输出比较单元（Output Compare Unit）进行初始化和控制。当计数器的值到达某个阈值时，OCU模块会自动开始比较并执行相应的操作。</p>
<p>OCU驱动还可以为下列功能提供服务：</p>
<ul>
<li><p>启动或停止输出通道；</p>
</li>
<li><p>设定某个阈值；</p>
</li>
<li><p>启用或禁用某个通道的通知函数；</p>
</li>
<li><p>获取计数器数值；</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/02/AUTOSAR/1.1.%E5%BE%AE%E6%8E%A7%E5%88%B6%E5%99%A8%E6%8A%BD%E8%B1%A1%E5%B1%82MCAL(%E9%A9%B1%E5%8A%A8%E5%B1%82)/" data-id="cljllekjx00025wvd3gah7g72" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/07/02/AUTOSAR/1.%E5%9F%BA%E7%A1%80%E8%BD%AF%E4%BB%B6%E5%B1%82(BSW)/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2023/07/02/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/07/02/Test/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/02/AUTOSAR/%E8%BD%AF%E4%BB%B6%E5%88%86%E5%B1%82%E6%9E%B6%E6%9E%84/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/02/AUTOSAR/%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF%E8%A7%84%E8%8C%83COM%E5%92%8C%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86NM/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/02/AUTOSAR/%E6%9E%B6%E6%9E%84%E8%AF%8A%E6%96%AD%E5%8A%9F%E8%83%BD/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/07/02/AUTOSAR/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%B1%BD%E8%BD%A6%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E8%A6%81%E7%94%A8AutoSar/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>